# NOTE: A separate config file is necessary for ERS-2, since the Level-1 pre-processor
#       expects one config file per platform (at least for now)
pysiral_package_config:
  l1p_id: &l1p_id "sgdr_v3p0"
  l1p_version: &l1p_version 1.2
  supported_source_datasets:
    - "envisat_sgdr_esa_v3p0"

# (Optional) Source data discovery settings
source_data_discovery: {}

# (Optional) Source data loader settings
source_data_loader: {}
# Output handler (will always be default handler -> only options)

polar_ocean_detection:
    orbit_coverage: half_orbit
    target_hemisphere: [nh, sh]
    polar_latitude_threshold: 45.0
    allow_nonocean_segment_nrecords: 250
    ocean_mininum_size_nrecords: 5
    split_at_time_gap_seconds: 10.

orbit_segment_connect:
    max_timedelta_seconds: 10.

# Settings for l1p netCDF output
output:
    l1p_id: *l1p_id
    l1p_version: *l1p_version
    export_minimum_n_records: 10

# NOTE: if no options are required use an empty mapping {} instead of null!
processing_items:

    # Compute the leading edge width parameters (full, first half & second half)
    - label: "Compute Leading Edge Width"
      stage: post_ocean_segment_extraction
      class_name: L1PLeadingEdgeWidth
      options:
          tfmra_leading_edge_start: 0.05
          tfmra_leading_edge_end: 0.95
          tfmra_options:
              noise_level_range_bin_idx: [10, 20]
              first_maximum_ignore_leading_bins: 10

    # Compute waveform peakiness CCI style
    - label: "Compute Waveform Peakiness"
      stage: post_ocean_segment_extraction
      class_name: L1PWaveformPeakiness
      options:
          skip_first_range_bins: 10
          norm_is_range_bin: True

    # Compute the leading edge quality indicator
    # This class will add three parameters to the l1p classifier data group:
    #  1. Leading edge quality
    #  2. first maximum index
    #  3. first maximum power (in units of peak power)
    - label: "Compute Leading Edge Quality"
      stage: post_ocean_segment_extraction
      class_name: L1PLeadingEdgeQuality
      options:
        # Power threshold for the normalized waveform
        # that the first maximum has to exceed
        first_maximum_normalized_power_threshold:
            lrm: 0.5
        # Number of range bins prior to the first maximum
        # that are to compute the quality factor
        leading_edge_lookup_window:
            lrm: 20
        # Minimum valid first maximum index
        minimum_valid_first_maximum_index:
            lrm: 10

    # Compute the leading edge peakiness
    # This class will add three parameters to the l1p classifier data group:
    #  1. Leading edge peakiness
    - label: "Compute Leading Edge Peakiness"
      stage: post_ocean_segment_extraction
      class_name: L1PLeadingEdgePeakiness
      options:
        # Power threshold for the normalized waveform
        # that the first maximum has to exceed
        window_size: 3
